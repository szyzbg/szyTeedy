<!DOCTYPE html>
<html ng-app="docs">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit">
    
    <title ng-bind-template="{{ pageTitle ? pageTitle : appName }}">Teedy</title>
    
    <!-- 图标和主题 -->
    <link rel="shortcut icon" href="../api/theme/image/logo">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="../api/theme/stylesheet" type="text/css" id="theme-stylesheet">

    <!-- 样式表 -->
    <!-- ref:css style/style.min.css?@build.date@ -->
    <link rel="stylesheet" href="style/bootstrap.css" type="text/css">
    <link rel="stylesheet" href="style/fontawesome.css" type="text/css">
    <link rel="stylesheet/less" href="style/main.less" type="text/css">
    <link rel="stylesheet" href="style/colorpicker.css" type="text/css">
    <link rel="stylesheet" href="style/pell.css" type="text/css">
    <link rel="stylesheet" href="style/ng-onboarding.css" type="text/css">
    <!-- endref -->

    <!-- 开发配置 -->
    <!-- ref:remove -->
    <script>
      less = {
        env: 'development',
        async: false,
        fileAsync: false,
        poll: 1000,
        dumpLineNumbers: 'all'
      };
    </script>
    <style>
        /* 主色调定义 */
        :root {
        --primary-color: #87CEEB;       /* 天蓝色 */
        --secondary-color: #B0E0E6;    /* 粉蓝色 */
        --accent-color: #4682B4;       /* 钢蓝色 */
        --hover-color: #6CA6CD;        /* 中等蓝色 */
    }

        /* 导航栏样式 */
        .navbar-default {
    background: linear-gradient(145deg, var(--accent-color), var(--primary-color));
    box-shadow: 0 2px 10px rgba(135, 206, 235, 0.2);
}

        .navbar-brand span[style*="#2aabd2"] {
            color: white !important;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* 按钮特效 */
        .btn-primary,
.navbar-toggle {
    box-shadow: 0 4px 6px rgba(135, 206, 235, 0.3);
}
.dropdown-menu {
    box-shadow: 0 4px 15px rgba(70, 130, 180, 0.2);
}

        .btn-primary:hover,
        .navbar-toggle:hover,
        .dropdown-menu a:hover {
            background-color: var(--hover-color);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(135, 206, 235, 0.3);
        }

        .btn-primary:active,
        .navbar-toggle:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(70, 130, 180, 0.2);
        }

        /* 动态波纹效果 */
        .btn-primary:after,
        .navbar-toggle:after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255,255,255,0.5);
            opacity: 0;
            border-radius: 100%;
            transform: translate(-50%, -50%);
            animation: ripple 1s ease-out;
        }

        @keyframes ripple {
            0% { transform: scale(1); opacity: 0.5; }
            100% { transform: scale(20); opacity: 0; }
        }

        /* 导航菜单特效 */
        .nav > li > a {
            transition: all 0.3s ease;
            border-radius: 20px;
            margin: 2px 5px;
        }

        .nav > li > a:hover {
            background: rgba(0,0,0,0.15) !important;
            transform: scale(1.05);
        }

        /* 添加悬停动画效果 */
.alert-danger {
    transition: all 0.3s ease;
}

.alert-danger:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(70, 130, 180, 0.2);
}

        /* 页脚样式 */
        .footer {
    background: linear-gradient(145deg, #f0f8ff, #e1f0ff); /* 浅蓝色渐变 */
    border-top: 2px solid var(--secondary-color); /* 使用定义的辅助色 */
}

.footer-links a {
    color: var(--accent-color) !important; /* 使用强调色（钢蓝） */
    transition: color 0.3s ease;
}

.footer-links a:hover {
    color: var(--primary-color) !important; /* 主色调（天空蓝） */
    text-decoration: none;
}

/* 语言选择器 */
.dropdown-menu {
    border: 2px solid var(--secondary-color); /* 辅助色边框（粉蓝） */
    box-shadow: 0 4px 15px rgba(70, 130, 180, 0.2); /* 钢蓝阴影 */
}

.dropdown-menu a:hover {
    background-color: #e1f0ff !important; /* 浅蓝色背景 */
}

        /* 动态内容过渡 */
        .animated-fade {
            animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* 注册模块切换效果 */
.registration-section {
    margin: 30px 0;
    transition: all 0.3s ease;
}

/* 触发按钮样式 */
.btn-primary {
    background: linear-gradient(145deg, #4682B4, #6CA6CD);
    padding: 12px 25px;
    border: none;
    transition: transform 0.3s ease;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(70, 130, 180, 0.3);
}

/* 表单头部 */
.form-header {
    position: relative;
    margin-bottom: 20px;
}

.btn-close {
    position: absolute;
    right: -10px;
    top: -10px;
    color: #666;
    opacity: 0.7;
}

.btn-close:hover {
    color: #4682B4;
}

/* 表单操作按钮 */
.form-actions {
    margin-top: 25px;
    text-align: right;
}

.form-actions .btn {
    margin-left: 10px;
    border-radius: 15px;
    padding: 8px 20px;
}
    </style>
</head>

<body translate-cloak ng-cloak>
    <!-- 用户引导浮层 -->
    <onboarding-popover ng-if="onboardingEnabled" enabled="onboardingEnabled" steps="onboardingSteps"></onboarding-popover>

    <!-- 导航栏 -->
    <nav class="navbar navbar-default" role="navigation" ng-controller="Navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" 
                    ng-init="isCollapsed = true" 
                    ng-click="isCollapsed = !isCollapsed">
                <span class="sr-only">{{ 'index.toggle_navigation' | translate }}</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">
                <span ng-if="appName == 'Teedy'"><span style="color: #2aabd2;">teedy</span></span>
                <span ng-if="appName != 'Teedy'" style="color: #888;">{{ appName }}</span>
            </a>
        </div>

        <!-- 导航菜单 -->
        <div class="collapse navbar-collapse" uib-collapse="isCollapsed">
            <!-- 主菜单 -->
            <ul class="nav navbar-nav" ng-show="!userInfo.anonymous">
                <li ui-sref-active="{ active: 'document.**' }">
                    <a href="#/document"><span class="fas fa-book"></span> {{ 'index.nav_documents' | translate }}</a>
                </li>
                <li ui-sref-active="{ active: 'tag.**' }" id="navigation-tag">
                    <a href="#/tag"><span class="fas fa-tags"></span> {{ 'index.nav_tags' | translate }}</a>
                </li>
                <li ui-sref-active="{ active: 'user.**', active2: 'group.**' }">
                    <a href="#/user"><span class="fas fa-user"></span> {{ 'index.nav_users_groups' | translate }}</a>
                </li>
            </ul>

            <!-- 右侧菜单（调整顺序后） -->
            <ul class="nav navbar-nav navbar-right" ng-show="!userInfo.anonymous">
                <!-- 设置菜单前置 -->
                <li ui-sref-active="{ active: 'settings.**' }" ng-show="userInfo.username != 'guest'">
                    <a href="#/settings/account">
                        <span class="fas fa-cog"></span> {{ 'index.nav_settings' | translate }}
                    </a>
                </li>
                
                <!-- 用户信息 -->
                <li>
                    <a href="{{ userInfo.username == 'guest' ? '#/user/guest' : '#/settings/account' }}"
                       translate-attr="{ title: 'index.logged_as' }" 
                       translate-values="{ username: userInfo.username }">
                        <span class="fas fa-user-circle"></span>
                        {{ userInfo.username }}
                    </a>
                </li>
                
                <!-- 退出按钮保持在最后 -->
                <li>
                    <a href="#" ng-click="logout($event)">
                        <span class="fas fa-sign-out-alt"></span> {{ 'index.logout' | translate }}
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- 主内容区 -->
    <div class="container-fluid main-content">
        
        <!-- 存储配额警告提升到内容区顶部 -->
        <div class="global-storage-alert">
            <div class="alert alert-danger" 
                 ng-show="app.global_storage_quota && app.global_storage_quota * 0.8 < app.global_storage_current"
                 translate="index.global_quota_warning"
                 translate-values="{ 
                     current: app.global_storage_current / 1000000, 
                     percent: app.global_storage_current / app.global_storage_quota * 100, 
                     total: app.global_storage_quota / 1000000 
                 }">
            </div>
        </div>
        
        <!-- 动态内容视图 -->
        <div ui-view="page" class="animated-fade"></div>
<!-- 修改后的注册模块 -->
<div class="registration-section" ng-if="!userInfo.anonymous">
    <!-- 注册触发按钮 -->
    <div class="row" ng-show="!showRegistrationForm">
        <div class="col-md-2 col-md-offset-5">
            <button class="btn btn-primary btn-block" 
                    ng-click="showRegistrationForm = true"
                    style="border-radius: 20px;">
                <span class="fas fa-user-plus"></span> 立即注册
            </button>
        </div>
    </div>

    <!-- 注册表单内容 -->
    <div class="row" ng-show="showRegistrationForm">
        <div class="col-md-4 col-md-offset-4">
            <div class="registration-box">
                <!-- 表单标题 -->
                <div class="form-header">
                    <h3 class="text-center" style="color: #4682B4; margin-bottom: 25px;">
                        <span class="fas fa-user-plus"></span> 创建新账户
                    </h3>
                    <button class="btn btn-link btn-close" 
                            ng-click="showRegistrationForm = false">
                        <span class="fas fa-times"></span>
                    </button>
                </div>
                
                <!-- 注册表单 -->
                <form class="registration-form">
                    <!-- 表单字段保持原有结构不变 -->
                    <div class="form-group">
                        <input type="text" class="form-control" 
                               placeholder="用户名"
                               ng-model="regData.username">
                    </div>
                    
                    <div class="form-group">
                        <input type="email" class="form-control" 
                               placeholder="邮箱地址"
                               ng-model="regData.email">
                    </div>
                    
                    <div class="form-group">
                        <input type="password" class="form-control" 
                               placeholder="密码"
                               ng-model="regData.password">
                    </div>
                    
                    <div class="form-group">
                        <input type="password" class="form-control" 
                               placeholder="确认密码"
                               ng-model="regData.confirmPassword">
                    </div>
                    
                    <!-- 表单操作按钮 -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-default" 
                                ng-click="showRegistrationForm = false">
                            取消
                        </button>
                        <button type="submit" class="btn btn-primary" 
                                ng-click="register()">
                            <span class="fas fa-check-circle"></span> 立即注册
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
    </div>

    <!-- 页脚 -->
    <footer class="footer" ng-controller="Footer">
        <div class="container-fluid">
            <div class="row footer-content">
                <div class="col-md-12 text-center">
                    <!-- 调整后的页脚元素顺序 -->
                    <ul class="footer-links list-inline">
                        <li class="version-info">
                            <span class="label label-default">v{{ app.current_version }}</span>
                        </li>
                        <li class="api-link">
                            <a href="apidoc/" class="text-muted">
                                <span class="fas fa-code"></span>
                                {{ 'document.default.api_documentation' | translate }}
                            </a>
                        </li>
                        <li class="copyright">
                            <span class="text-muted" translate="document.default.footer_sismics"></span>
                        </li>
                        <li class="language-selector" uib-dropdown>
                            <a href uib-dropdown-toggle class="text-muted">
                                <span class="fas fa-globe"></span>
                                <span ng-switch="currentLang">
                                    <span ng-switch-when="en">English</span>
                                    <span ng-switch-when="fr">Français</span>
                                    <span ng-switch-when="de">Deutsch</span>
                                    <span ng-switch-when="it">Italiano</span>
                                    <span ng-switch-when="es">Española</span>
                                    <span ng-switch-when="pt">Português</span>
                                    <span ng-switch-when="el">Ελληνικά</span>
                                    <span ng-switch-when="ru">Pусский</span>
                                    <span ng-switch-when="pl">Polski</span>
                                    <span ng-switch-when="zh_CN">简体中文</span>
                                    <span ng-switch-when="zh_TW">繁體中文</span>
                                    <span ng-switch-when="sq_AL">Shqip</span>
                                </span>
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-right">
                                <li><a ng-click="changeLanguage('en')" ng-class="{ 'active-lang': currentLang == 'en' }">English</a></li>
                                <li><a ng-click="changeLanguage('fr')" ng-class="{ 'active-lang': currentLang == 'fr' }">Français</a></li>
                                <li><a ng-click="changeLanguage('de')" ng-class="{ 'active-lang': currentLang == 'de' }">Deutsch</a></li>
                                <li><a ng-click="changeLanguage('it')" ng-class="{ 'active-lang': currentLang == 'it' }">Italiano</a></li>
                                <li><a ng-click="changeLanguage('es')" ng-class="{ 'active-lang': currentLang == 'es' }">Española</a></li>
                                <li><a ng-click="changeLanguage('pt')" ng-class="{ 'active-lang': currentLang == 'pt' }">Português</a></li>
                                <li><a ng-click="changeLanguage('el')" ng-class="{ 'active-lang': currentLang == 'el' }">Ελληνικά</a></li>
                                <li><a ng-click="changeLanguage('ru')" ng-class="{ 'active-lang': currentLang == 'ru' }">Pусский</a></li>
                                <li><a ng-click="changeLanguage('pl')" ng-class="{ 'active-lang': currentLang == 'pl' }">Polski</a></li>
                                <li><a ng-click="changeLanguage('zh_CN')" ng-class="{ 'active-lang': currentLang == 'zh_CN' }">简体中文</a></li>
                                <li><a ng-click="changeLanguage('zh_TW')" ng-class="{ 'active-lang': currentLang == 'zh_TW' }">繁體中文</a></li>
                                <li><a ng-click="changeLanguage('sq_AL')" ng-class="{ 'active-lang': currentLang == 'sq_AL' }">Shqip</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- 脚本部分保持原始顺序 -->
    <!-- ref:js docs.min.js?@build.date@ -->
    <script>
        // 添加按钮点击动画
        document.addEventListener('DOMContentLoaded', function() {
            [].slice.call(document.querySelectorAll('button, a, .btn')).forEach(function(button) {
                button.addEventListener('click', function(e) {
                    let rect = button.getBoundingClientRect();
                    let x = e.clientX - rect.left;
                    let y = e.clientY - rect.top;
                    
                    let ripple = document.createElement('div');
                    ripple.style.cssText = `
                        position: absolute;
                        width: 20px;
                        height: 20px;
                        background: rgba(255,255,255,0.4);
                        border-radius: 50%;
                        transform: translate(-50%, -50%);
                        pointer-events: none;
                        left: ${x}px;
                        top: ${y}px;
                        animation: rippleEffect 0.6s linear;
                    `;

                    button.appendChild(ripple);
                    setTimeout(() => ripple.remove(), 600);
                });
            });
        });
    </script>
    <script src="lib/jquery.js"></script>
    <script src="lib/jquery.ui.js"></script>
    <script src="lib/less.js"></script>
    <script src="lib/underscore.js"></script>
    <script src="lib/colorpicker.js"></script>
    <script src="lib/pell.js"></script>
    <script src="lib/angular.js"></script>
    <script src="lib/angular.translate.js"></script>
    <script src="lib/angular.sanitize.js"></script>
    <script src="lib/angular.touch.js"></script>
    <script src="lib/angular.tmhDynamicLocale.js"></script>
    <script src="lib/angular.ui-router.js"></script>
    <script src="lib/angular.ui-bootstrap.js"></script>
    <script src="lib/angular.ui-sortable.js"></script>
    <script src="lib/angular.ui-validate.js"></script>
    <script src="lib/angular.restangular.js"></script>
    <script src="lib/angular.colorpicker.js"></script>
    <script src="lib/angular.file-upload.js"></script>
    <script src="lib/angular.ngprogress.js"></script>
    <script src="lib/angular.qrcode.js"></script>
    <script src="lib/angular.timeago.js"></script>
    <script src="lib/angular.ng-onboarding.js"></script>
    
    <!-- 应用脚本 -->
    <script src="app/docs/app.js"></script>
    <!-- 保持所有控制器的原始引用顺序 -->
    <script src="app/docs/controller/Login.js"></script>
    <script src="app/docs/controller/Main.js"></script>
    <script src="app/docs/controller/ModalPasswordLost.js"></script>
    <script src="app/docs/controller/ModalFeedback.js"></script>
    <script src="app/docs/controller/ModalImport.js"></script>
    <script src="app/docs/controller/PasswordReset.js"></script>
    <script src="app/docs/controller/Navigation.js"></script>
    <script src="app/docs/controller/Footer.js"></script>
    <!-- 文档相关控制器 -->
    <script src="app/docs/controller/document/Document.js"></script>
    <script src="app/docs/controller/document/DocumentDefault.js"></script>
    <script src="app/docs/controller/document/DocumentEdit.js"></script>
    <script src="app/docs/controller/document/DocumentView.js"></script>
    <script src="app/docs/controller/document/DocumentViewContent.js"></script>
    <script src="app/docs/controller/document/DocumentViewWorkflow.js"></script>
    <script src="app/docs/controller/document/DocumentViewPermissions.js"></script>
    <script src="app/docs/controller/document/DocumentViewActivity.js"></script>
    <script src="app/docs/controller/document/DocumentModalShare.js"></script>
    <script src="app/docs/controller/document/DocumentModalPdf.js"></script>
    <script src="app/docs/controller/document/DocumentModalAddTag.js"></script>
    <!-- 文件相关控制器 -->
    <script src="app/docs/controller/document/FileView.js"></script>
    <script src="app/docs/controller/document/FileModalView.js"></script>
    <script src="app/docs/controller/document/FileRename.js"></script>
    <script src="app/docs/controller/document/ModalFileVersions.js"></script>
    <!-- 标签相关控制器 -->
    <script src="app/docs/controller/tag/Tag.js"></script>
    <script src="app/docs/controller/tag/TagEdit.js"></script>
    <!-- 设置相关控制器 -->
    <script src="app/docs/controller/settings/Settings.js"></script>
    <script src="app/docs/controller/settings/SettingsDefault.js"></script>
    <script src="app/docs/controller/settings/SettingsAccount.js"></script>
    <script src="app/docs/controller/settings/SettingsConfig.js"></script>
    <script src="app/docs/controller/settings/SettingsInbox.js"></script>
    <script src="app/docs/controller/settings/SettingsSecurity.js"></script>
    <script src="app/docs/controller/settings/SettingsSecurityModalDisableTotp.js"></script>
    <script src="app/docs/controller/settings/SettingsSession.js"></script>
    <script src="app/docs/controller/settings/SettingsMonitoring.js"></script>
    <script src="app/docs/controller/settings/SettingsWorkflow.js"></script>
    <script src="app/docs/controller/settings/SettingsWorkflowEdit.js"></script>
    <script src="app/docs/controller/settings/SettingsUser.js"></script>
    <script src="app/docs/controller/settings/SettingsUserEdit.js"></script>
    <script src="app/docs/controller/settings/SettingsGroup.js"></script>
    <script src="app/docs/controller/settings/SettingsGroupEdit.js"></script>
    <script src="app/docs/controller/settings/SettingsVocabulary.js"></script>
    <script src="app/docs/controller/settings/SettingsMetadata.js"></script>
    <script src="app/docs/controller/settings/SettingsLdap.js"></script>
    <!-- 用户组相关控制器 -->
    <script src="app/docs/controller/usergroup/UserGroup.js"></script>
    <script src="app/docs/controller/usergroup/UserProfile.js"></script>
    <script src="app/docs/controller/usergroup/GroupProfile.js"></script>
    <!-- 服务和指令 -->
    <script src="app/docs/service/User.js"></script>
    <script src="app/docs/filter/Filesize.js"></script>
    <script src="app/docs/directive/SelectTag.js"></script>
    <script src="app/docs/directive/SelectRelation.js"></script>
    <script src="app/docs/directive/AuditLog.js"></script>
    <script src="app/docs/directive/ImgError.js"></script>
    <script src="app/docs/directive/Acl.js"></script>
    <script src="app/docs/directive/AclEdit.js"></script>
    <script src="app/docs/directive/Pell.js"></script>
    <script src="app/docs/directive/AddSpaceBetween.js"></script>
    <script src="app/docs/directive/InvertTextColor.js"></script>
    <!-- endref -->
</body>
</html>
</html>